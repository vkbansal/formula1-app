---
import MainLayout from 'layouts/MainLayout.astro';
import Breadcrumbs from 'components/Breadcrumbs.astro';

import seasons from 'data/seasons.yaml';
import metadata from 'data/metadata.yaml';

import type { TableData } from './client/index';
import { Client } from './client/index';

export async function getStaticPaths() {
	return seasons.map((year) => ({ params: { year: year.toString() } }));
}

const { year: yearStr } = Astro.params;
const year = parseInt(yearStr as string, 10);
const { rounds, drivers } = await import(`data/season/${year}.yaml`);
---

<MainLayout title='Home'>
	<Breadcrumbs
		links={[
			{ label: 'Seasons', href: '/seasons/' },
			{ label: `${year} Season`, href: '' },
		]}
	/>
	<div>
		<h1>
			{year} Season {metadata.currentSeason === year ? '(Current Season)' : ''}
		</h1>
	</div>
	<Client racesData={rounds} client:load />
</MainLayout>
